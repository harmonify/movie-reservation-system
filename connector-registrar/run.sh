#!/bin/bash

set -eu

echo "Environment variables:"
echo "CONNECT_URL=$CONNECT_URL"
echo "SCHEMA_REGISTRY_URL=$SCHEMA_REGISTRY_URL"
echo "USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_CONNECTOR_ID=$USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_CONNECTOR_ID"
echo "USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_CONNECTOR_NAME=$USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_CONNECTOR_NAME"
echo "USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DB_HOST=$USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DB_HOST"
echo "USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DB_PORT=$USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DB_PORT"
echo "USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DB_USER=$USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DB_USER"
echo "USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DB_PASSWORD=$USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DB_PASSWORD"
echo "USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DB_NAME=$USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DB_NAME"
echo "USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DB_SCHEMA=$USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DB_SCHEMA"
echo "USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DB_TABLE=$USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DB_TABLE"
echo "USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_RUN_MIGRATION=$USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_RUN_MIGRATION"
echo "USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DELETE_OLD_CONNECTORS=$USER_SERVICE_OUTBOX_POSTGRESQL_SOURCE_DELETE_OLD_CONNECTORS"
echo "MOVIE_SERVICE_MOVIES_MONGODB_SOURCE_CONNECTOR_ID=$MOVIE_SERVICE_MOVIES_MONGODB_SOURCE_CONNECTOR_ID"
echo "MOVIE_SERVICE_MOVIES_MONGODB_SOURCE_CONNECTOR_NAME=$MOVIE_SERVICE_MOVIES_MONGODB_SOURCE_CONNECTOR_NAME"
echo "MOVIE_SERVICE_MOVIES_MONGODB_SOURCE_MONGO_DATABASE_NAME=$MOVIE_SERVICE_MOVIES_MONGODB_SOURCE_MONGO_DATABASE_NAME"
echo "MOVIE_SERVICE_MOVIES_MONGODB_SOURCE_MONGO_CONNECTION_STRING=$MOVIE_SERVICE_MOVIES_MONGODB_SOURCE_MONGO_CONNECTION_STRING"
echo "MOVIE_SERVICE_MOVIES_MONGODB_SOURCE_MONGO_COLLECTION_NAME=$MOVIE_SERVICE_MOVIES_MONGODB_SOURCE_MONGO_COLLECTION_NAME"
echo "MOVIE_SERVICE_MOVIES_MONGODB_SOURCE_RUN_MIGRATION=$MOVIE_SERVICE_MOVIES_MONGODB_SOURCE_RUN_MIGRATION"
echo "MOVIE_SERVICE_MOVIES_MONGODB_SOURCE_DELETE_OLD_CONNECTORS=$MOVIE_SERVICE_MOVIES_MONGODB_SOURCE_DELETE_OLD_CONNECTORS"
echo "MOVIE_SEARCH_SERVICE_MOVIES_ELASTICSEARCH_SINK_CONNECTOR_ID=$MOVIE_SEARCH_SERVICE_MOVIES_ELASTICSEARCH_SINK_CONNECTOR_ID"
echo "MOVIE_SEARCH_SERVICE_MOVIES_ELASTICSEARCH_SINK_CONNECTOR_NAME=$MOVIE_SEARCH_SERVICE_MOVIES_ELASTICSEARCH_SINK_CONNECTOR_NAME"
echo "MOVIE_SEARCH_SERVICE_MOVIES_ELASTICSEARCH_SINK_ELASTICSEARCH_CONNECTION_URL=$MOVIE_SEARCH_SERVICE_MOVIES_ELASTICSEARCH_SINK_ELASTICSEARCH_CONNECTION_URL"
echo "MOVIE_SEARCH_SERVICE_MOVIES_ELASTICSEARCH_SINK_ELASTICSEARCH_USERNAME=$MOVIE_SEARCH_SERVICE_MOVIES_ELASTICSEARCH_SINK_ELASTICSEARCH_USERNAME"
echo "MOVIE_SEARCH_SERVICE_MOVIES_ELASTICSEARCH_SINK_RUN_MIGRATION=$MOVIE_SEARCH_SERVICE_MOVIES_ELASTICSEARCH_SINK_RUN_MIGRATION"
echo "MOVIE_SEARCH_SERVICE_MOVIES_ELASTICSEARCH_SINK_DELETE_OLD_CONNECTORS=$MOVIE_SEARCH_SERVICE_MOVIES_ELASTICSEARCH_SINK_DELETE_OLD_CONNECTORS"
echo "MOVIE_SEARCH_SERVICE_MOVIES_ELASTICSEARCH_SINK_DELETE_OLD_INDEX=$MOVIE_SEARCH_SERVICE_MOVIES_ELASTICSEARCH_SINK_DELETE_OLD_INDEX"

CURR_DIR="$(dirname "$0")"

"$CURR_DIR/register_outbox_user_service_postgresql_source_connector.sh"
"$CURR_DIR/register_movies_movie_service_mongodb_source_connector.sh"
"$CURR_DIR/register_movies_movie_search_service_elasticsearch_sink_connector.sh"
